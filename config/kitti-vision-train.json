{
    "session_name": "train-dense-3D-5-resume",
    "previous_session": "train-dense-3D-5",

    "home_dir": "/home/mgr",
    "detect_anomaly": false,

    "networks": {
        "match_type": "zncc",
        "dense_match": true,
        "unet": {
            "n_weight_score": 1,
            "bilinear": true,
            "first_feature_dimension": 8,
            "depth": 4
        },
        "keypoint_block": {
            "patch_height": 16,
            "patch_width": 16,
            "softmax_temp": 1.0,
            "align_corners": false,
            "grid_sample": true
        },
        "matcher_block": {
            "softmax_temperature": 0.01
        },
        "outlier_rejection": {
            "on": true,
            "type": "3D",
            "threshold": 4.0
        }
    },

    "optimizer": {
        "type": "Adam",
        "lr": 0.0001,
        "weight_decay": 0
    },

    "dataset": {
        "data_dir": "/home/mgr/data/kitti/dataset",
        "seq": {
            "train": ["00"],
            "val": ["00"],
            "test": ["00"]
        },
	    "sensor": "camera",
        "images": {
            "height": 370,
            "width": 800,
            "height_scaled": 370,
            "width_scaled": 800,
            "input_channel": ["rgb"]
        },
        "disparity": {
            "minDisparity": 0,
            "numDisparities": 96,
            "blockSize": 7,
            "preFilterCap": 30,
            "uniquenessRatio": 20,
            "P1": 392,
            "P2": 1568,
            "speckleWindowSize": 200,
            "speckleRange": 1,
            "disp12MaxDiff": -1
        }
    },

    "loss": {
        "types": ["keypoint_3D", "svd"],
        "weights": {"keypoint_2D":  0.01, "keypoint_3D":  1.0, "svd": 10.0},
        "start_svd_epoch": 2
    },

    "record": {
        "save_names": ["T_tgt_src", "T_tgt_src_pred", "inliers", "src_valid", "pseudo_valid", "weights"]
    },


    "train_loader": {
        "batch_size": 2,
        "window_size": 2,
        "num_workers": 2
    },

    "test_loader": {
        "batch_size": 1,
        "window_size": 2,
        "num_workers": 2
    },

    "trainer": {
        "max_epochs": 100,
        "validate": {
            "on": true,
            "patience": 20
        }
    }
}
